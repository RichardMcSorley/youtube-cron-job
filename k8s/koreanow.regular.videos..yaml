apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: koreanow-regular-videos
spec:
  schedule: "* * * * *"
  suspend: false
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: koreanow-regular-videos-0
            image: gcr.io/dongdongchat/youtube-cron-job
            command: ["npm", "start"]
            env:
              - name: FUNC_NAME
                value: "getVideosAndUpdateDB"
              - name: FUNC_PARAM
                value: "?&channelId=UCR-L8oZkHzgDh1ahJhH2WDQ&part=snippet&type=video&order=date&maxResults=5"
              - name: LIB_NAME
                value: "youtube"
              - name: FIREBASE_DATABASE_URL
                value: https://dongdongchat.firebaseio.com
            envFrom:
              - configMapRef:
                  name: firebase
              - configMapRef:
                  name: youtube-api-key-2
          restartPolicy: OnFailure
          hostNetwork: true
